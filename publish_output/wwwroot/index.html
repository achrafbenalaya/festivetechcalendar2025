<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Festive Tech Calendar 2025</title>
    <base href="/" />
    <!-- WebAssembly preload handled by Blazor loader -->
    <script>
        // Load Bootstrap CSS from local path when available, otherwise fall back to CDN.
        (function () {
            var localHref = 'lib/bootstrap/dist/css/bootstrap.min.css';
            var cdnHref = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css';

            function insertLink(href) {
                var l = document.createElement('link');
                l.rel = 'stylesheet';
                l.href = href;
                document.head.appendChild(l);
            }

            try {
                // Try a HEAD request to check availability (will fail in some environments but it's best-effort)
                fetch(localHref, { method: 'HEAD' }).then(function (r) {
                    if (r.ok) insertLink(localHref);
                    else insertLink(cdnHref);
                }).catch(function () { insertLink(cdnHref); });
            } catch (e) {
                insertLink(cdnHref);
            }
        })();
    </script>

    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="MyFestiveTech.styles.css" rel="stylesheet" />
    <script type="importmap"></script>

    <script>
        (function () {
            try {
                var saved = localStorage.getItem('ft-theme');
                var theme = (saved === 'light' || saved === 'dark')
                    ? saved
                    : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
                document.documentElement.setAttribute('data-bs-theme', theme);
            } catch { }
        })();
    </script>
</head>

<body>
    <div id="app">
        <svg class="loading-progress">
            <circle r="40%" cx="50%" cy="50%" />
            <circle r="40%" cx="50%" cy="50%" />
        </svg>
        <div class="loading-progress-text"></div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="." class="reload">Reload</a>
        <span class="dismiss">ðŸ—™</span>
    </div>

    <script>
        // Load Bootstrap JS from local path when available, otherwise fall back to CDN.
        (function () {
            var localSrc = 'lib/bootstrap/dist/js/bootstrap.bundle.min.js';
            var cdnSrc = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js';

            function insertScript(src, onload) {
                var s = document.createElement('script');
                s.src = src;
                if (onload) s.onload = onload;
                document.body.appendChild(s);
            }

            try {
                fetch(localSrc, { method: 'HEAD' }).then(function (r) {
                    if (r.ok) insertScript(localSrc, function () { console.debug('Loaded local bootstrap'); });
                    else insertScript(cdnSrc, function () { console.debug('Loaded CDN bootstrap'); });
                }).catch(function () { insertScript(cdnSrc); });
            } catch (e) {
                insertScript(cdnSrc);
            }
        })();
    </script>

    <script src="js/theme.js"></script>
    <script src="_framework/blazor.webassembly.js"></script>
</body>

</html>
